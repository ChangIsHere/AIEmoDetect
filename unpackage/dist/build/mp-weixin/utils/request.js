"use strict";const e=require("../common/vendor.js"),s="http://git.yukexx.com:13023",a={chatWithLLM:a=>(s=>{const{url:a,method:t,data:o,headers:r}=s;return console.log("Request URL:",a),console.log("Request Data:",o),console.log("Request Headers:",r),new Promise(((s,d)=>{e.index.request({url:a,method:t||"POST",data:o,header:r,success:e=>{200===e.statusCode?s(e.data):d(e.data||{message:`请求失败，状态码: ${e.statusCode}`})},fail:e=>{console.error("Network request failed:",e),d({message:"网络请求失败，请检查网络连接",detail:e})}})}))})({url:`${s}/chat/text`,method:"POST",data:{question:a.message,session_id:a.sessionId},headers:{"Content-Type":"application/x-www-form-urlencoded"}}),uploadVideoForAnalysis:a=>{const{filePath:t,taskType:o="emotion_analysis",detailsLevel:r="high",question:d="分析视频中人物的情感，并且给出详细原因",maxFrames:i=100}=a;return new Promise(((a,u)=>{e.index.uploadFile({url:`${s}/analyze/video`,filePath:t,name:"file",formData:{task_type:o,details_level:r,question:d,max_frames:i},success:e=>{if(200===e.statusCode)try{const s=JSON.parse(e.data);a(s)}catch(s){u({message:"视频分析接口返回数据解析失败",detail:e.data,error:s})}else u({message:`上传失败: ${e.statusCode}`,statusCode:e.statusCode})},fail:e=>{u({message:"视频分析请求失败",error:e})}})}))},analyzeEmotionFromVideo:a=>{const{filePath:t,userName:o="小明",userId:r="明世隐",userSex:d="男",userAge:i="21"}=a;return new Promise(((a,u)=>{e.index.uploadFile({url:`${s}/emotion/analysis`,filePath:t,name:"file",formData:{userName:o,userId:r,userSex:d,userAge:i},success:e=>{if(200===e.statusCode)try{const s=JSON.parse(e.data);a(s)}catch(s){u({message:"分析接口返回数据解析失败",detail:e.data,error:s})}else u({message:`上传失败: ${e.statusCode}`,statusCode:e.statusCode})},fail:e=>{u({message:"情绪分析请求失败",error:e})}})}))}};exports.request=a;
