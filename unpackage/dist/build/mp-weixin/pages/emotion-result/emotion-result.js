"use strict";const e=require("../../common/vendor.js"),s=e.defineComponent({data:()=>({rawResults:null,scaleTypeTitle:"",showAnalysisContent:!1,loading:!1,mainEmotion:"neutral",emotionLabel:"平静",emotionScore:65,scoreColor:"#6847c2",analysisText:"点击“生成分析结果”按钮获取报告。",suggestions:[]}),onLoad(e){this.getOpenerEventChannel().on("acceptResultDataFromOpenerPage",((e=null)=>{console.log("从问卷页面接收到结果:",e.data),this.rawResults=e.data,"DASS21"===this.rawResults.scaleType?this.scaleTypeTitle="DASS-21":"PHQ9"===this.rawResults.scaleType&&(this.scaleTypeTitle="PHQ-9")}))},methods:{goBack(){e.index.navigateBack()},generateAnalysis(){if(this.loading)return null;this.loading=!0,e.index.showLoading({title:"正在生成分析报告...",mask:!0}),setTimeout((()=>{e.index.hideLoading(),this.loading=!1,this.showAnalysisContent=!0,this.processAnalysisData()}),2e3)},processAnalysisData(){if(!this.rawResults)return console.warn("未接收到量表结果，生成备用数据。"),this.generateFallbackData(),null;const e=this.rawResults.scaleType,s=this.rawResults.totalScore;let n=`您完成了${e}量表，总分为${s}分。\n\n`,t="neutral",o=65,a="平静",i="#6847c2",l=["根据您的回答，建议您关注情绪健康，保持积极心态。","尝试与信任的人分享您的感受，寻求支持。"];"DASS21"===e?s>=30?(t="anxious",o=20,a="严重焦虑/抑郁/压力",i="#FF4500",n+="您的情绪可能处于较高压力状态，建议寻求专业帮助。\n",l=["强烈建议寻求专业心理咨询和评估。","学习压力管理技巧，如冥想、放松练习。","确保充足的休息和规律的作息。"]):s>=15?(t="sad",o=40,a="中度焦虑/抑郁/压力",i="#FFD700",n+="您的情绪可能存在一定程度的波动，建议保持关注。\n",l=["尝试与亲友交流，分享您的感受。","进行适度的体育锻炼，有助于改善情绪。","保持健康的生活习惯，充足睡眠和均衡饮食。"]):(t="happy",o=80,a="情绪良好",i="#32CD32",n+="您目前情绪状态良好，请继续保持。\n",l=["继续保持积极乐观的心态。","可以将您的好心情分享给身边的人。","保持健康的生活习惯，享受生活。"]):"PHQ9"===e&&(s>=15?(t="sad",o=25,a="中度至重度抑郁",i="#DC143C",n+="您的抑郁症状可能较明显，建议及时寻求专业帮助。\n",l=["强烈建议咨询心理健康专业人士，进行进一步评估和干预。","避免孤立，尝试与支持您的朋友或家人保持联系。","培养一些兴趣爱好，分散注意力，缓解负面情绪。"]):s>=5?(t="anxious",o=50,a="轻度抑郁",i="#FF8C00",n+="您可能存在轻度抑郁症状，建议您保持关注和自我调节。\n",l=["尝试调整作息，保证充足的睡眠。","进行规律的户外活动，如散步、跑步，接触自然。","学习情绪管理技巧，如冥想、放松训练。"]):(t="happy",o=90,a="无抑郁症状",i="#008000",n+="您没有明显的抑郁症状，情绪状态良好。\n",l=["继续保持积极健康的生活方式。","定期进行心理健康自查，关注情绪变化。"])),this.mainEmotion=t,this.emotionLabel=a,this.emotionScore=o,this.scoreColor=i,this.analysisText=n+"\n\n以下是您的详细答案：\n"+UTS.JSON.stringify(this.rawResults.answers,null,2),this.suggestions=l},generateFallbackData(){this.scaleTypeTitle="未知量表",this.mainEmotion="neutral",this.emotionLabel="平静",this.emotionScore=60,this.scoreColor="#808080",this.analysisText="未能加载具体的分析结果。请确保已完成量表测评。\n\n如果问题持续存在，请联系技术支持。",this.suggestions=["请返回量表页面完成测评。","如果您已完成测评，请尝试刷新页面。"]},shareResult(){e.index.showToast({title:"分享功能开发中",icon:"none"})},findProfessional(){e.index.showToast({title:"预约功能开发中",icon:"none"})}}});const n=e._export_sfc(s,[["render",function(s,n,t,o,a,i){return e.e({a:e.o(((...e)=>i.goBack&&i.goBack(...e))),b:e.t(a.scaleTypeTitle),c:!a.showAnalysisContent},a.showAnalysisContent?e.e({g:"happy"===a.mainEmotion},("happy"===a.mainEmotion||"sad"===a.mainEmotion||"angry"===a.mainEmotion||a.mainEmotion,{}),{h:"sad"===a.mainEmotion,i:"angry"===a.mainEmotion,j:"anxious"===a.mainEmotion,k:e.n(a.mainEmotion),l:e.t(a.emotionLabel),m:e.t(a.emotionScore),n:a.emotionScore+"%",o:a.scoreColor,p:e.t(a.analysisText),q:e.f(a.suggestions,((s,n,t)=>({a:e.t(n+1),b:e.t(s),c:n}))),r:e.o(((...e)=>i.shareResult&&i.shareResult(...e))),s:e.o(((...e)=>i.findProfessional&&i.findProfessional(...e)))}):{d:e.t(a.loading?"生成中...":"生成分析结果"),e:a.loading,f:e.o(((...e)=>i.generateAnalysis&&i.generateAnalysis(...e)))},{t:e.sei(e.gei(s,""),"view")})}],["__scopeId","data-v-81400f87"]]);wx.createPage(n);
